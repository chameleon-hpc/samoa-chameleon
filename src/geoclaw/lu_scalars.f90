!===== first main loop, I = 1
AMAX=0.d0
IF (DABS(A11).GT.AMAX) AMAX=DABS(A11)
IF (DABS(A12).GT.AMAX) AMAX=DABS(A12)
IF (DABS(A13).GT.AMAX) AMAX=DABS(A13)
IF (DABS(A14).GT.AMAX) AMAX=DABS(A14)
IF (DABS(A15).GT.AMAX) AMAX=DABS(A15)
IF (DABS(A16).GT.AMAX) AMAX=DABS(A16)
VV1 = 1.d0 / AMAX
!===== first main loop, I = 2
AMAX=0.d0
IF (DABS(A21).GT.AMAX) AMAX=DABS(A21)
IF (DABS(A22).GT.AMAX) AMAX=DABS(A22)
IF (DABS(A23).GT.AMAX) AMAX=DABS(A23)
IF (DABS(A24).GT.AMAX) AMAX=DABS(A24)
IF (DABS(A25).GT.AMAX) AMAX=DABS(A25)
IF (DABS(A26).GT.AMAX) AMAX=DABS(A26)
VV2 = 1.d0 / AMAX
!===== first main loop, I = 3
AMAX=0.d0
IF (DABS(A31).GT.AMAX) AMAX=DABS(A31)
IF (DABS(A32).GT.AMAX) AMAX=DABS(A32)
IF (DABS(A33).GT.AMAX) AMAX=DABS(A33)
IF (DABS(A34).GT.AMAX) AMAX=DABS(A34)
IF (DABS(A35).GT.AMAX) AMAX=DABS(A35)
IF (DABS(A36).GT.AMAX) AMAX=DABS(A36)
VV3 = 1.d0 / AMAX
!===== first main loop, I = 4
AMAX=0.d0
IF (DABS(A41).GT.AMAX) AMAX=DABS(A41)
IF (DABS(A42).GT.AMAX) AMAX=DABS(A42)
IF (DABS(A43).GT.AMAX) AMAX=DABS(A43)
IF (DABS(A44).GT.AMAX) AMAX=DABS(A44)
IF (DABS(A45).GT.AMAX) AMAX=DABS(A45)
IF (DABS(A46).GT.AMAX) AMAX=DABS(A46)
VV4 = 1.d0 / AMAX
!===== first main loop, I = 5
AMAX=0.d0
IF (DABS(A51).GT.AMAX) AMAX=DABS(A51)
IF (DABS(A52).GT.AMAX) AMAX=DABS(A52)
IF (DABS(A53).GT.AMAX) AMAX=DABS(A53)
IF (DABS(A54).GT.AMAX) AMAX=DABS(A54)
IF (DABS(A55).GT.AMAX) AMAX=DABS(A55)
IF (DABS(A56).GT.AMAX) AMAX=DABS(A56)
VV5 = 1.d0 / AMAX
!===== first main loop, I = 6
AMAX=0.d0
IF (DABS(A61).GT.AMAX) AMAX=DABS(A61)
IF (DABS(A62).GT.AMAX) AMAX=DABS(A62)
IF (DABS(A63).GT.AMAX) AMAX=DABS(A63)
IF (DABS(A64).GT.AMAX) AMAX=DABS(A64)
IF (DABS(A65).GT.AMAX) AMAX=DABS(A65)
IF (DABS(A66).GT.AMAX) AMAX=DABS(A66)
VV6 = 1.d0 / AMAX




!==== second main loop, J = 1
AMAX = 0.d0
SUMM = A11
A11 = SUMM
DUM = VV1*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 1
  AMAX = DUM
END IF
SUMM = A21
A21 = SUMM
DUM = VV2*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 2
  AMAX = DUM
END IF
SUMM = A31
A31 = SUMM
DUM = VV3*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 3
  AMAX = DUM
END IF
SUMM = A41
A41 = SUMM
DUM = VV4*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 4
  AMAX = DUM
END IF
SUMM = A51
A51 = SUMM
DUM = VV5*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 5
  AMAX = DUM
END IF
SUMM = A61
A61 = SUMM
DUM = VV6*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 6
  AMAX = DUM
END IF
IF(J.NE.IMAX) THEN
  IF(IMAX==1) DUM = A11
  IF(IMAX==2) DUM = A21
  IF(IMAX==3) DUM = A31
  IF(IMAX==4) DUM = A41
  IF(IMAX==5) DUM = A51
  IF(IMAX==6) DUM = A61
  IF(IMAX==1) A11 = A11
  IF(IMAX==2) A21 = A11
  IF(IMAX==3) A31 = A11
  IF(IMAX==4) A41 = A11
  IF(IMAX==5) A51 = A11
  IF(IMAX==6) A61 = A11
  A11 = DUM
  IF(IMAX==1) DUM = A12
  IF(IMAX==2) DUM = A22
  IF(IMAX==3) DUM = A32
  IF(IMAX==4) DUM = A42
  IF(IMAX==5) DUM = A52
  IF(IMAX==6) DUM = A62
  IF(IMAX==1) A12 = A12
  IF(IMAX==2) A22 = A12
  IF(IMAX==3) A32 = A12
  IF(IMAX==4) A42 = A12
  IF(IMAX==5) A52 = A12
  IF(IMAX==6) A62 = A12
  A12 = DUM
  IF(IMAX==1) DUM = A13
  IF(IMAX==2) DUM = A23
  IF(IMAX==3) DUM = A33
  IF(IMAX==4) DUM = A43
  IF(IMAX==5) DUM = A53
  IF(IMAX==6) DUM = A63
  IF(IMAX==1) A13 = A13
  IF(IMAX==2) A23 = A13
  IF(IMAX==3) A33 = A13
  IF(IMAX==4) A43 = A13
  IF(IMAX==5) A53 = A13
  IF(IMAX==6) A63 = A13
  A13 = DUM
  IF(IMAX==1) DUM = A14
  IF(IMAX==2) DUM = A24
  IF(IMAX==3) DUM = A34
  IF(IMAX==4) DUM = A44
  IF(IMAX==5) DUM = A54
  IF(IMAX==6) DUM = A64
  IF(IMAX==1) A14 = A14
  IF(IMAX==2) A24 = A14
  IF(IMAX==3) A34 = A14
  IF(IMAX==4) A44 = A14
  IF(IMAX==5) A54 = A14
  IF(IMAX==6) A64 = A14
  A14 = DUM
  IF(IMAX==1) DUM = A15
  IF(IMAX==2) DUM = A25
  IF(IMAX==3) DUM = A35
  IF(IMAX==4) DUM = A45
  IF(IMAX==5) DUM = A55
  IF(IMAX==6) DUM = A65
  IF(IMAX==1) A15 = A15
  IF(IMAX==2) A25 = A15
  IF(IMAX==3) A35 = A15
  IF(IMAX==4) A45 = A15
  IF(IMAX==5) A55 = A15
  IF(IMAX==6) A65 = A15
  A15 = DUM
  IF(IMAX==1) DUM = A16
  IF(IMAX==2) DUM = A26
  IF(IMAX==3) DUM = A36
  IF(IMAX==4) DUM = A46
  IF(IMAX==5) DUM = A56
  IF(IMAX==6) DUM = A66
  IF(IMAX==1) A16 = A16
  IF(IMAX==2) A26 = A16
  IF(IMAX==3) A36 = A16
  IF(IMAX==4) A46 = A16
  IF(IMAX==5) A56 = A16
  IF(IMAX==6) A66 = A16
  A16 = DUM
  IF(IMAX==1) VV1 = VV1
  IF(IMAX==2) VV2 = VV1
  IF(IMAX==3) VV3 = VV1
  IF(IMAX==4) VV4 = VV1
  IF(IMAX==5) VV5 = VV1
  IF(IMAX==6) VV6 = VV1
END IF
INDX1 = IMAX
IF(DABS(A11) < TINY) A11 = TINY
DUM = 1.d0 / A11
A21 = A21*DUM
A31 = A31*DUM
A41 = A41*DUM
A51 = A51*DUM
A61 = A61*DUM
!==== second main loop, J = 2
SUMM = A12
A12 = SUMM
AMAX = 0.d0
SUMM = A22
SUMM = SUMM - A21*A12
A22 = SUMM
DUM = VV2*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 2
  AMAX = DUM
END IF
SUMM = A32
SUMM = SUMM - A31*A12
A32 = SUMM
DUM = VV3*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 3
  AMAX = DUM
END IF
SUMM = A42
SUMM = SUMM - A41*A12
A42 = SUMM
DUM = VV4*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 4
  AMAX = DUM
END IF
SUMM = A52
SUMM = SUMM - A51*A12
A52 = SUMM
DUM = VV5*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 5
  AMAX = DUM
END IF
SUMM = A62
SUMM = SUMM - A61*A12
A62 = SUMM
DUM = VV6*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 6
  AMAX = DUM
END IF
IF(J.NE.IMAX) THEN
  IF(IMAX==1) DUM = A11
  IF(IMAX==2) DUM = A21
  IF(IMAX==3) DUM = A31
  IF(IMAX==4) DUM = A41
  IF(IMAX==5) DUM = A51
  IF(IMAX==6) DUM = A61
  IF(IMAX==1) A11 = A21
  IF(IMAX==2) A21 = A21
  IF(IMAX==3) A31 = A21
  IF(IMAX==4) A41 = A21
  IF(IMAX==5) A51 = A21
  IF(IMAX==6) A61 = A21
  A21 = DUM
  IF(IMAX==1) DUM = A12
  IF(IMAX==2) DUM = A22
  IF(IMAX==3) DUM = A32
  IF(IMAX==4) DUM = A42
  IF(IMAX==5) DUM = A52
  IF(IMAX==6) DUM = A62
  IF(IMAX==1) A12 = A22
  IF(IMAX==2) A22 = A22
  IF(IMAX==3) A32 = A22
  IF(IMAX==4) A42 = A22
  IF(IMAX==5) A52 = A22
  IF(IMAX==6) A62 = A22
  A22 = DUM
  IF(IMAX==1) DUM = A13
  IF(IMAX==2) DUM = A23
  IF(IMAX==3) DUM = A33
  IF(IMAX==4) DUM = A43
  IF(IMAX==5) DUM = A53
  IF(IMAX==6) DUM = A63
  IF(IMAX==1) A13 = A23
  IF(IMAX==2) A23 = A23
  IF(IMAX==3) A33 = A23
  IF(IMAX==4) A43 = A23
  IF(IMAX==5) A53 = A23
  IF(IMAX==6) A63 = A23
  A23 = DUM
  IF(IMAX==1) DUM = A14
  IF(IMAX==2) DUM = A24
  IF(IMAX==3) DUM = A34
  IF(IMAX==4) DUM = A44
  IF(IMAX==5) DUM = A54
  IF(IMAX==6) DUM = A64
  IF(IMAX==1) A14 = A24
  IF(IMAX==2) A24 = A24
  IF(IMAX==3) A34 = A24
  IF(IMAX==4) A44 = A24
  IF(IMAX==5) A54 = A24
  IF(IMAX==6) A64 = A24
  A24 = DUM
  IF(IMAX==1) DUM = A15
  IF(IMAX==2) DUM = A25
  IF(IMAX==3) DUM = A35
  IF(IMAX==4) DUM = A45
  IF(IMAX==5) DUM = A55
  IF(IMAX==6) DUM = A65
  IF(IMAX==1) A15 = A25
  IF(IMAX==2) A25 = A25
  IF(IMAX==3) A35 = A25
  IF(IMAX==4) A45 = A25
  IF(IMAX==5) A55 = A25
  IF(IMAX==6) A65 = A25
  A25 = DUM
  IF(IMAX==1) DUM = A16
  IF(IMAX==2) DUM = A26
  IF(IMAX==3) DUM = A36
  IF(IMAX==4) DUM = A46
  IF(IMAX==5) DUM = A56
  IF(IMAX==6) DUM = A66
  IF(IMAX==1) A16 = A26
  IF(IMAX==2) A26 = A26
  IF(IMAX==3) A36 = A26
  IF(IMAX==4) A46 = A26
  IF(IMAX==5) A56 = A26
  IF(IMAX==6) A66 = A26
  A26 = DUM
  IF(IMAX==1) VV1 = VV2
  IF(IMAX==2) VV2 = VV2
  IF(IMAX==3) VV3 = VV2
  IF(IMAX==4) VV4 = VV2
  IF(IMAX==5) VV5 = VV2
  IF(IMAX==6) VV6 = VV2
END IF
INDX2 = IMAX
IF(DABS(A22) < TINY) A22 = TINY
DUM = 1.d0 / A22
A32 = A32*DUM
A42 = A42*DUM
A52 = A52*DUM
A62 = A62*DUM
!==== second main loop, J = 3
SUMM = A13
A13 = SUMM
SUMM = A23
SUMM = SUMM - A21*A13
A23 = SUMM
AMAX = 0.d0
SUMM = A33
SUMM = SUMM - A31*A13
SUMM = SUMM - A32*A23
A33 = SUMM
DUM = VV3*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 3
  AMAX = DUM
END IF
SUMM = A43
SUMM = SUMM - A41*A13
SUMM = SUMM - A42*A23
A43 = SUMM
DUM = VV4*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 4
  AMAX = DUM
END IF
SUMM = A53
SUMM = SUMM - A51*A13
SUMM = SUMM - A52*A23
A53 = SUMM
DUM = VV5*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 5
  AMAX = DUM
END IF
SUMM = A63
SUMM = SUMM - A61*A13
SUMM = SUMM - A62*A23
A63 = SUMM
DUM = VV6*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 6
  AMAX = DUM
END IF
IF(J.NE.IMAX) THEN
  IF(IMAX==1) DUM = A11
  IF(IMAX==2) DUM = A21
  IF(IMAX==3) DUM = A31
  IF(IMAX==4) DUM = A41
  IF(IMAX==5) DUM = A51
  IF(IMAX==6) DUM = A61
  IF(IMAX==1) A11 = A31
  IF(IMAX==2) A21 = A31
  IF(IMAX==3) A31 = A31
  IF(IMAX==4) A41 = A31
  IF(IMAX==5) A51 = A31
  IF(IMAX==6) A61 = A31
  A31 = DUM
  IF(IMAX==1) DUM = A12
  IF(IMAX==2) DUM = A22
  IF(IMAX==3) DUM = A32
  IF(IMAX==4) DUM = A42
  IF(IMAX==5) DUM = A52
  IF(IMAX==6) DUM = A62
  IF(IMAX==1) A12 = A32
  IF(IMAX==2) A22 = A32
  IF(IMAX==3) A32 = A32
  IF(IMAX==4) A42 = A32
  IF(IMAX==5) A52 = A32
  IF(IMAX==6) A62 = A32
  A32 = DUM
  IF(IMAX==1) DUM = A13
  IF(IMAX==2) DUM = A23
  IF(IMAX==3) DUM = A33
  IF(IMAX==4) DUM = A43
  IF(IMAX==5) DUM = A53
  IF(IMAX==6) DUM = A63
  IF(IMAX==1) A13 = A33
  IF(IMAX==2) A23 = A33
  IF(IMAX==3) A33 = A33
  IF(IMAX==4) A43 = A33
  IF(IMAX==5) A53 = A33
  IF(IMAX==6) A63 = A33
  A33 = DUM
  IF(IMAX==1) DUM = A14
  IF(IMAX==2) DUM = A24
  IF(IMAX==3) DUM = A34
  IF(IMAX==4) DUM = A44
  IF(IMAX==5) DUM = A54
  IF(IMAX==6) DUM = A64
  IF(IMAX==1) A14 = A34
  IF(IMAX==2) A24 = A34
  IF(IMAX==3) A34 = A34
  IF(IMAX==4) A44 = A34
  IF(IMAX==5) A54 = A34
  IF(IMAX==6) A64 = A34
  A34 = DUM
  IF(IMAX==1) DUM = A15
  IF(IMAX==2) DUM = A25
  IF(IMAX==3) DUM = A35
  IF(IMAX==4) DUM = A45
  IF(IMAX==5) DUM = A55
  IF(IMAX==6) DUM = A65
  IF(IMAX==1) A15 = A35
  IF(IMAX==2) A25 = A35
  IF(IMAX==3) A35 = A35
  IF(IMAX==4) A45 = A35
  IF(IMAX==5) A55 = A35
  IF(IMAX==6) A65 = A35
  A35 = DUM
  IF(IMAX==1) DUM = A16
  IF(IMAX==2) DUM = A26
  IF(IMAX==3) DUM = A36
  IF(IMAX==4) DUM = A46
  IF(IMAX==5) DUM = A56
  IF(IMAX==6) DUM = A66
  IF(IMAX==1) A16 = A36
  IF(IMAX==2) A26 = A36
  IF(IMAX==3) A36 = A36
  IF(IMAX==4) A46 = A36
  IF(IMAX==5) A56 = A36
  IF(IMAX==6) A66 = A36
  A36 = DUM
  IF(IMAX==1) VV1 = VV3
  IF(IMAX==2) VV2 = VV3
  IF(IMAX==3) VV3 = VV3
  IF(IMAX==4) VV4 = VV3
  IF(IMAX==5) VV5 = VV3
  IF(IMAX==6) VV6 = VV3
END IF
INDX3 = IMAX
IF(DABS(A33) < TINY) A33 = TINY
DUM = 1.d0 / A33
A43 = A43*DUM
A53 = A53*DUM
A63 = A63*DUM
!==== second main loop, J = 4
SUMM = A14
A14 = SUMM
SUMM = A24
SUMM = SUMM - A21*A14
A24 = SUMM
SUMM = A34
SUMM = SUMM - A31*A14
SUMM = SUMM - A32*A24
A34 = SUMM
AMAX = 0.d0
SUMM = A44
SUMM = SUMM - A41*A14
SUMM = SUMM - A42*A24
SUMM = SUMM - A43*A34
A44 = SUMM
DUM = VV4*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 4
  AMAX = DUM
END IF
SUMM = A54
SUMM = SUMM - A51*A14
SUMM = SUMM - A52*A24
SUMM = SUMM - A53*A34
A54 = SUMM
DUM = VV5*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 5
  AMAX = DUM
END IF
SUMM = A64
SUMM = SUMM - A61*A14
SUMM = SUMM - A62*A24
SUMM = SUMM - A63*A34
A64 = SUMM
DUM = VV6*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 6
  AMAX = DUM
END IF
IF(J.NE.IMAX) THEN
  IF(IMAX==1) DUM = A11
  IF(IMAX==2) DUM = A21
  IF(IMAX==3) DUM = A31
  IF(IMAX==4) DUM = A41
  IF(IMAX==5) DUM = A51
  IF(IMAX==6) DUM = A61
  IF(IMAX==1) A11 = A41
  IF(IMAX==2) A21 = A41
  IF(IMAX==3) A31 = A41
  IF(IMAX==4) A41 = A41
  IF(IMAX==5) A51 = A41
  IF(IMAX==6) A61 = A41
  A41 = DUM
  IF(IMAX==1) DUM = A12
  IF(IMAX==2) DUM = A22
  IF(IMAX==3) DUM = A32
  IF(IMAX==4) DUM = A42
  IF(IMAX==5) DUM = A52
  IF(IMAX==6) DUM = A62
  IF(IMAX==1) A12 = A42
  IF(IMAX==2) A22 = A42
  IF(IMAX==3) A32 = A42
  IF(IMAX==4) A42 = A42
  IF(IMAX==5) A52 = A42
  IF(IMAX==6) A62 = A42
  A42 = DUM
  IF(IMAX==1) DUM = A13
  IF(IMAX==2) DUM = A23
  IF(IMAX==3) DUM = A33
  IF(IMAX==4) DUM = A43
  IF(IMAX==5) DUM = A53
  IF(IMAX==6) DUM = A63
  IF(IMAX==1) A13 = A43
  IF(IMAX==2) A23 = A43
  IF(IMAX==3) A33 = A43
  IF(IMAX==4) A43 = A43
  IF(IMAX==5) A53 = A43
  IF(IMAX==6) A63 = A43
  A43 = DUM
  IF(IMAX==1) DUM = A14
  IF(IMAX==2) DUM = A24
  IF(IMAX==3) DUM = A34
  IF(IMAX==4) DUM = A44
  IF(IMAX==5) DUM = A54
  IF(IMAX==6) DUM = A64
  IF(IMAX==1) A14 = A44
  IF(IMAX==2) A24 = A44
  IF(IMAX==3) A34 = A44
  IF(IMAX==4) A44 = A44
  IF(IMAX==5) A54 = A44
  IF(IMAX==6) A64 = A44
  A44 = DUM
  IF(IMAX==1) DUM = A15
  IF(IMAX==2) DUM = A25
  IF(IMAX==3) DUM = A35
  IF(IMAX==4) DUM = A45
  IF(IMAX==5) DUM = A55
  IF(IMAX==6) DUM = A65
  IF(IMAX==1) A15 = A45
  IF(IMAX==2) A25 = A45
  IF(IMAX==3) A35 = A45
  IF(IMAX==4) A45 = A45
  IF(IMAX==5) A55 = A45
  IF(IMAX==6) A65 = A45
  A45 = DUM
  IF(IMAX==1) DUM = A16
  IF(IMAX==2) DUM = A26
  IF(IMAX==3) DUM = A36
  IF(IMAX==4) DUM = A46
  IF(IMAX==5) DUM = A56
  IF(IMAX==6) DUM = A66
  IF(IMAX==1) A16 = A46
  IF(IMAX==2) A26 = A46
  IF(IMAX==3) A36 = A46
  IF(IMAX==4) A46 = A46
  IF(IMAX==5) A56 = A46
  IF(IMAX==6) A66 = A46
  A46 = DUM
  IF(IMAX==1) VV1 = VV4
  IF(IMAX==2) VV2 = VV4
  IF(IMAX==3) VV3 = VV4
  IF(IMAX==4) VV4 = VV4
  IF(IMAX==5) VV5 = VV4
  IF(IMAX==6) VV6 = VV4
END IF
INDX4 = IMAX
IF(DABS(A44) < TINY) A44 = TINY
DUM = 1.d0 / A44
A54 = A54*DUM
A64 = A64*DUM
!==== second main loop, J = 5
SUMM = A15
A15 = SUMM
SUMM = A25
SUMM = SUMM - A21*A15
A25 = SUMM
SUMM = A35
SUMM = SUMM - A31*A15
SUMM = SUMM - A32*A25
A35 = SUMM
SUMM = A45
SUMM = SUMM - A41*A15
SUMM = SUMM - A42*A25
SUMM = SUMM - A43*A35
A45 = SUMM
AMAX = 0.d0
SUMM = A55
SUMM = SUMM - A51*A15
SUMM = SUMM - A52*A25
SUMM = SUMM - A53*A35
SUMM = SUMM - A54*A45
A55 = SUMM
DUM = VV5*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 5
  AMAX = DUM
END IF
SUMM = A65
SUMM = SUMM - A61*A15
SUMM = SUMM - A62*A25
SUMM = SUMM - A63*A35
SUMM = SUMM - A64*A45
A65 = SUMM
DUM = VV6*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 6
  AMAX = DUM
END IF
IF(J.NE.IMAX) THEN
  IF(IMAX==1) DUM = A11
  IF(IMAX==2) DUM = A21
  IF(IMAX==3) DUM = A31
  IF(IMAX==4) DUM = A41
  IF(IMAX==5) DUM = A51
  IF(IMAX==6) DUM = A61
  IF(IMAX==1) A11 = A51
  IF(IMAX==2) A21 = A51
  IF(IMAX==3) A31 = A51
  IF(IMAX==4) A41 = A51
  IF(IMAX==5) A51 = A51
  IF(IMAX==6) A61 = A51
  A51 = DUM
  IF(IMAX==1) DUM = A12
  IF(IMAX==2) DUM = A22
  IF(IMAX==3) DUM = A32
  IF(IMAX==4) DUM = A42
  IF(IMAX==5) DUM = A52
  IF(IMAX==6) DUM = A62
  IF(IMAX==1) A12 = A52
  IF(IMAX==2) A22 = A52
  IF(IMAX==3) A32 = A52
  IF(IMAX==4) A42 = A52
  IF(IMAX==5) A52 = A52
  IF(IMAX==6) A62 = A52
  A52 = DUM
  IF(IMAX==1) DUM = A13
  IF(IMAX==2) DUM = A23
  IF(IMAX==3) DUM = A33
  IF(IMAX==4) DUM = A43
  IF(IMAX==5) DUM = A53
  IF(IMAX==6) DUM = A63
  IF(IMAX==1) A13 = A53
  IF(IMAX==2) A23 = A53
  IF(IMAX==3) A33 = A53
  IF(IMAX==4) A43 = A53
  IF(IMAX==5) A53 = A53
  IF(IMAX==6) A63 = A53
  A53 = DUM
  IF(IMAX==1) DUM = A14
  IF(IMAX==2) DUM = A24
  IF(IMAX==3) DUM = A34
  IF(IMAX==4) DUM = A44
  IF(IMAX==5) DUM = A54
  IF(IMAX==6) DUM = A64
  IF(IMAX==1) A14 = A54
  IF(IMAX==2) A24 = A54
  IF(IMAX==3) A34 = A54
  IF(IMAX==4) A44 = A54
  IF(IMAX==5) A54 = A54
  IF(IMAX==6) A64 = A54
  A54 = DUM
  IF(IMAX==1) DUM = A15
  IF(IMAX==2) DUM = A25
  IF(IMAX==3) DUM = A35
  IF(IMAX==4) DUM = A45
  IF(IMAX==5) DUM = A55
  IF(IMAX==6) DUM = A65
  IF(IMAX==1) A15 = A55
  IF(IMAX==2) A25 = A55
  IF(IMAX==3) A35 = A55
  IF(IMAX==4) A45 = A55
  IF(IMAX==5) A55 = A55
  IF(IMAX==6) A65 = A55
  A55 = DUM
  IF(IMAX==1) DUM = A16
  IF(IMAX==2) DUM = A26
  IF(IMAX==3) DUM = A36
  IF(IMAX==4) DUM = A46
  IF(IMAX==5) DUM = A56
  IF(IMAX==6) DUM = A66
  IF(IMAX==1) A16 = A56
  IF(IMAX==2) A26 = A56
  IF(IMAX==3) A36 = A56
  IF(IMAX==4) A46 = A56
  IF(IMAX==5) A56 = A56
  IF(IMAX==6) A66 = A56
  A56 = DUM
  IF(IMAX==1) VV1 = VV5
  IF(IMAX==2) VV2 = VV5
  IF(IMAX==3) VV3 = VV5
  IF(IMAX==4) VV4 = VV5
  IF(IMAX==5) VV5 = VV5
  IF(IMAX==6) VV6 = VV5
END IF
INDX5 = IMAX
IF(DABS(A55) < TINY) A55 = TINY
DUM = 1.d0 / A55
A65 = A65*DUM
!==== second main loop, J = 6
SUMM = A16
A16 = SUMM
SUMM = A26
SUMM = SUMM - A21*A16
A26 = SUMM
SUMM = A36
SUMM = SUMM - A31*A16
SUMM = SUMM - A32*A26
A36 = SUMM
SUMM = A46
SUMM = SUMM - A41*A16
SUMM = SUMM - A42*A26
SUMM = SUMM - A43*A36
A46 = SUMM
SUMM = A56
SUMM = SUMM - A51*A16
SUMM = SUMM - A52*A26
SUMM = SUMM - A53*A36
SUMM = SUMM - A54*A46
A56 = SUMM
AMAX = 0.d0
SUMM = A66
SUMM = SUMM - A61*A16
SUMM = SUMM - A62*A26
SUMM = SUMM - A63*A36
SUMM = SUMM - A64*A46
SUMM = SUMM - A65*A56
A66 = SUMM
DUM = VV6*DABS(SUMM)
IF(DUM.GE.AMAX) THEN
  IMAX = 6
  AMAX = DUM
END IF
IF(J.NE.IMAX) THEN
  IF(IMAX==1) DUM = A11
  IF(IMAX==2) DUM = A21
  IF(IMAX==3) DUM = A31
  IF(IMAX==4) DUM = A41
  IF(IMAX==5) DUM = A51
  IF(IMAX==6) DUM = A61
  IF(IMAX==1) A11 = A61
  IF(IMAX==2) A21 = A61
  IF(IMAX==3) A31 = A61
  IF(IMAX==4) A41 = A61
  IF(IMAX==5) A51 = A61
  IF(IMAX==6) A61 = A61
  A61 = DUM
  IF(IMAX==1) DUM = A12
  IF(IMAX==2) DUM = A22
  IF(IMAX==3) DUM = A32
  IF(IMAX==4) DUM = A42
  IF(IMAX==5) DUM = A52
  IF(IMAX==6) DUM = A62
  IF(IMAX==1) A12 = A62
  IF(IMAX==2) A22 = A62
  IF(IMAX==3) A32 = A62
  IF(IMAX==4) A42 = A62
  IF(IMAX==5) A52 = A62
  IF(IMAX==6) A62 = A62
  A62 = DUM
  IF(IMAX==1) DUM = A13
  IF(IMAX==2) DUM = A23
  IF(IMAX==3) DUM = A33
  IF(IMAX==4) DUM = A43
  IF(IMAX==5) DUM = A53
  IF(IMAX==6) DUM = A63
  IF(IMAX==1) A13 = A63
  IF(IMAX==2) A23 = A63
  IF(IMAX==3) A33 = A63
  IF(IMAX==4) A43 = A63
  IF(IMAX==5) A53 = A63
  IF(IMAX==6) A63 = A63
  A63 = DUM
  IF(IMAX==1) DUM = A14
  IF(IMAX==2) DUM = A24
  IF(IMAX==3) DUM = A34
  IF(IMAX==4) DUM = A44
  IF(IMAX==5) DUM = A54
  IF(IMAX==6) DUM = A64
  IF(IMAX==1) A14 = A64
  IF(IMAX==2) A24 = A64
  IF(IMAX==3) A34 = A64
  IF(IMAX==4) A44 = A64
  IF(IMAX==5) A54 = A64
  IF(IMAX==6) A64 = A64
  A64 = DUM
  IF(IMAX==1) DUM = A15
  IF(IMAX==2) DUM = A25
  IF(IMAX==3) DUM = A35
  IF(IMAX==4) DUM = A45
  IF(IMAX==5) DUM = A55
  IF(IMAX==6) DUM = A65
  IF(IMAX==1) A15 = A65
  IF(IMAX==2) A25 = A65
  IF(IMAX==3) A35 = A65
  IF(IMAX==4) A45 = A65
  IF(IMAX==5) A55 = A65
  IF(IMAX==6) A65 = A65
  A65 = DUM
  IF(IMAX==1) DUM = A16
  IF(IMAX==2) DUM = A26
  IF(IMAX==3) DUM = A36
  IF(IMAX==4) DUM = A46
  IF(IMAX==5) DUM = A56
  IF(IMAX==6) DUM = A66
  IF(IMAX==1) A16 = A66
  IF(IMAX==2) A26 = A66
  IF(IMAX==3) A36 = A66
  IF(IMAX==4) A46 = A66
  IF(IMAX==5) A56 = A66
  IF(IMAX==6) A66 = A66
  A66 = DUM
  IF(IMAX==1) VV1 = VV6
  IF(IMAX==2) VV2 = VV6
  IF(IMAX==3) VV3 = VV6
  IF(IMAX==4) VV4 = VV6
  IF(IMAX==5) VV5 = VV6
  IF(IMAX==6) VV6 = VV6
END IF
INDX6 = IMAX
IF(DABS(A66) < TINY) A66 = TINY




II = 0
!==== third main loop, I = 1
LL = INDX1
IF(LL==1) SUMM = B1
IF(LL==2) SUMM = B2
IF(LL==3) SUMM = B3
IF(LL==4) SUMM = B4
IF(LL==5) SUMM = B5
IF(LL==6) SUMM = B6
IF(LL==1) B1 = B1
IF(LL==2) B2 = B1
IF(LL==3) B3 = B1
IF(LL==4) B4 = B1
IF(LL==5) B5 = B1
IF(LL==6) B6 = B1
IF(II.NE.0) THEN
ELSE IF (SUMM.NE.0.d0) THEN
  II = 1
END IF
B1 = SUMM
!==== third main loop, I = 2
LL = INDX2
IF(LL==1) SUMM = B1
IF(LL==2) SUMM = B2
IF(LL==3) SUMM = B3
IF(LL==4) SUMM = B4
IF(LL==5) SUMM = B5
IF(LL==6) SUMM = B6
IF(LL==1) B1 = B2
IF(LL==2) B2 = B2
IF(LL==3) B3 = B2
IF(LL==4) B4 = B2
IF(LL==5) B5 = B2
IF(LL==6) B6 = B2
IF(II.NE.0) THEN
  IF(1.GE.II) SUMM = SUMM - A21*B1
ELSE IF (SUMM.NE.0.d0) THEN
  II = 2
END IF
B2 = SUMM
!==== third main loop, I = 3
LL = INDX3
IF(LL==1) SUMM = B1
IF(LL==2) SUMM = B2
IF(LL==3) SUMM = B3
IF(LL==4) SUMM = B4
IF(LL==5) SUMM = B5
IF(LL==6) SUMM = B6
IF(LL==1) B1 = B3
IF(LL==2) B2 = B3
IF(LL==3) B3 = B3
IF(LL==4) B4 = B3
IF(LL==5) B5 = B3
IF(LL==6) B6 = B3
IF(II.NE.0) THEN
  IF(1.GE.II) SUMM = SUMM - A31*B1
  IF(2.GE.II) SUMM = SUMM - A32*B2
ELSE IF (SUMM.NE.0.d0) THEN
  II = 3
END IF
B3 = SUMM
!==== third main loop, I = 4
LL = INDX4
IF(LL==1) SUMM = B1
IF(LL==2) SUMM = B2
IF(LL==3) SUMM = B3
IF(LL==4) SUMM = B4
IF(LL==5) SUMM = B5
IF(LL==6) SUMM = B6
IF(LL==1) B1 = B4
IF(LL==2) B2 = B4
IF(LL==3) B3 = B4
IF(LL==4) B4 = B4
IF(LL==5) B5 = B4
IF(LL==6) B6 = B4
IF(II.NE.0) THEN
  IF(1.GE.II) SUMM = SUMM - A41*B1
  IF(2.GE.II) SUMM = SUMM - A42*B2
  IF(3.GE.II) SUMM = SUMM - A43*B3
ELSE IF (SUMM.NE.0.d0) THEN
  II = 4
END IF
B4 = SUMM
!==== third main loop, I = 5
LL = INDX5
IF(LL==1) SUMM = B1
IF(LL==2) SUMM = B2
IF(LL==3) SUMM = B3
IF(LL==4) SUMM = B4
IF(LL==5) SUMM = B5
IF(LL==6) SUMM = B6
IF(LL==1) B1 = B5
IF(LL==2) B2 = B5
IF(LL==3) B3 = B5
IF(LL==4) B4 = B5
IF(LL==5) B5 = B5
IF(LL==6) B6 = B5
IF(II.NE.0) THEN
  IF(1.GE.II) SUMM = SUMM - A51*B1
  IF(2.GE.II) SUMM = SUMM - A52*B2
  IF(3.GE.II) SUMM = SUMM - A53*B3
  IF(4.GE.II) SUMM = SUMM - A54*B4
ELSE IF (SUMM.NE.0.d0) THEN
  II = 5
END IF
B5 = SUMM
!==== third main loop, I = 6
LL = INDX6
IF(LL==1) SUMM = B1
IF(LL==2) SUMM = B2
IF(LL==3) SUMM = B3
IF(LL==4) SUMM = B4
IF(LL==5) SUMM = B5
IF(LL==6) SUMM = B6
IF(LL==1) B1 = B6
IF(LL==2) B2 = B6
IF(LL==3) B3 = B6
IF(LL==4) B4 = B6
IF(LL==5) B5 = B6
IF(LL==6) B6 = B6
IF(II.NE.0) THEN
  IF(1.GE.II) SUMM = SUMM - A61*B1
  IF(2.GE.II) SUMM = SUMM - A62*B2
  IF(3.GE.II) SUMM = SUMM - A63*B3
  IF(4.GE.II) SUMM = SUMM - A64*B4
  IF(5.GE.II) SUMM = SUMM - A65*B5
ELSE IF (SUMM.NE.0.d0) THEN
  II = 6
END IF
B6 = SUMM



!==== fourth main loop, I = 6
SUMM = B6
B6 = SUMM / A66
!==== fourth main loop, I = 5
SUMM = B5
SUMM = SUMM - A56*B6
B5 = SUMM / A55
!==== fourth main loop, I = 4
SUMM = B4
SUMM = SUMM - A45*B5
SUMM = SUMM - A46*B6
B4 = SUMM / A44
!==== fourth main loop, I = 3
SUMM = B3
SUMM = SUMM - A34*B4
SUMM = SUMM - A35*B5
SUMM = SUMM - A36*B6
B3 = SUMM / A33
!==== fourth main loop, I = 2
SUMM = B2
SUMM = SUMM - A23*B3
SUMM = SUMM - A24*B4
SUMM = SUMM - A25*B5
SUMM = SUMM - A26*B6
B2 = SUMM / A22
!==== fourth main loop, I = 1
SUMM = B1
SUMM = SUMM - A12*B2
SUMM = SUMM - A13*B3
SUMM = SUMM - A14*B4
SUMM = SUMM - A15*B5
SUMM = SUMM - A16*B6
B1 = SUMM / A11
